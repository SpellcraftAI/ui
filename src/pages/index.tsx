import Head from "next/head";
import { useSpell } from "../lib/useSpell";
import { SpellCacheContext } from "../lib/context";
import { readCache } from "../lib/cache";
import { type NextPage } from "next";

export const withSpellcraftTest = (Page: NextPage): NextPage => {
  const UserPage = ({ spellCache, ...props }: any) => (
    <SpellCacheContext.Provider value={{ spellCache }}>
      <Page {...props} />
    </SpellCacheContext.Provider>
  );

  return UserPage;
};

export function Home () {
  const spellResult = useSpell("purple text in small font");
  console.log({ spellResult });

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main>
        <span className={spellResult}>
          hello world
        </span>
      </main>
    </>
  );
}

export default withSpellcraftTest(Home);

export const getStaticProps = async (): Promise<any> => {
  const spellCache = readCache();
  console.log("index.getStaticProps", { spellCache });

  return {
    props: {
      spellCache
    }
  };
};
